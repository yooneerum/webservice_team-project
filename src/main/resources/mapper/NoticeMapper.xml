<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="NoticeMapper">

    <!-- 전체 공지 -->
    <select id="findAll" resultType="org.example.teamproject.vo.NoticeVO">
        SELECT *
        FROM notice
        ORDER BY id DESC
    </select>

    <!-- 공지 상세 -->
    <select id="findById" parameterType="int"
            resultType="org.example.teamproject.vo.NoticeVO">
        SELECT *
        FROM notice
        WHERE id = #{id}
    </select>

    <!-- 학급별 공지 -->
    <select id="findByClassCode" parameterType="string"
            resultType="org.example.teamproject.vo.NoticeVO">
        SELECT *
        FROM notice
        WHERE class_code = #{classCode}
        ORDER BY id DESC
    </select>

    <!-- 공지 작성 -->
    <insert id="insert"
            parameterType="org.example.teamproject.vo.NoticeVO"
            useGeneratedKeys="true"
            keyProperty="id">
        INSERT INTO notice (class_code, title, content, writer_id)
        VALUES (#{classCode}, #{title}, #{content}, #{writerId})
    </insert>

    <!-- =====================
         교사 담당 학급 공지 목록  ⭐ 추가
         ===================== -->
    <select id="findByTeacherClasses"
            parameterType="list"
            resultType="org.example.teamproject.vo.NoticeVO">
        SELECT *
        FROM notice
        WHERE class_code IN
        <foreach collection="list" item="c" open="(" separator="," close=")">
            #{c.classCode}
        </foreach>
        ORDER BY id DESC
    </select>

</mapper>
